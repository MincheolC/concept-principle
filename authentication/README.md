# Authentication

## Authentication (인증, 너 누구야?)

Authentication은 사용자가 자신이 주장하는 신원(e.g. 아이디, 비밀번호)을 확인하는 과정을 말합니다.
다양한 인증 정보를 사용하여 신원을 확인합니다.

- **지식 기반 인증**: 사용자만이 알고 있는 정보(예: 비밀번호, PIN)를 사용
- **소유 기반 인증**: 사용자가 소유한 물리적 또는 디지털 토큰(예: 스마트 카드, 휴대폰)을 사용
- **생체 인증**: 사용자의 생체 정보(예: 지문, 홍채, 얼굴)를 사용

## Authorization (권한 부여, 너가 할 수 있는 일, 접근 가능한 범위는?)

권한 부여는 인증된 사용자가 특정한 리소스 또는 기능에 접근할 수 있는 권한을 부여하는 것을 의미합니다. 사용자가 로그인하여 인증되었다고 해도, 그 사용자가 모든 리소스에 접근할 수 있는 것은 아닙니다.
일반적으로 2가지 접근 제어를 활용합니다.

- **역할 기반 접근 제어(Role based access control)**
  - 엔티티를 역할로 나눠, 역할 별로 권한을 관리합니다. 주로 사용자의 권한을 관리합니다.
  - (실제 적용 예시)
    - ADMIN, MANAGER, USER 등
- **속성 기반 접근 제어 (Attribute based access control)**
  - **접근 제어에 다양한 속성을 고려해야할 때 사용.**
  - 사용자, 리소스, 환경 등의 속성을 기반으로 접근 권한을 결정하는 유연하고 **세밀한** 접근 제어 모델.
  - (실제 적용 예시)
    - 시간에 따른 접근 제어
    - 접속 위치에 따른 접근 제어
    - 문서 분류에 따른 접근 제어

## Authentication 유형

인증 방법에는 Basic Auth, Cookie-based, JWT, OAuth, OpenID, SAML 등 여러가지가 있습니다.

### JWT (JSON Web Token)

- JWT는 JSON 객체를 사용하여 가볍고 자가수용적인 방식으로 정보를 안전하게 전송하기 위한 개방형 표준([RFC 7519](https://datatracker.ietf.org/doc/html/rfc7519))
- **JWT 구성** (헤더, 페이로드, 서명 세 부분으로 구성되며, 각 부분은 점(.)으로 구분됨)
  - **헤더(Header):** 토큰의 유형과 암호화 알고리즘 등의 메타데이터를 포함합니다. 이 정보는 base64로 인코딩되어 있습니다.
  - **페이로드(Payload):** 토큰에 포함될 클레임(claim) 정보가 포함됩니다. 클레임은 토큰에 포함될 정보를 나타내며, 예를 들어 사용자 ID, 권한, 만료 시간 등이 있습니다. 이 정보 또한 base64로 인코딩되어 있습니다.
  - **서명(Signature):** 토큰의 무결성을 보장하기 위해 헤더와 페이로드를 함께 서명한 값입니다. 서명은 헤더와 페이로드를 인코딩하지 않으며, 일반적으로 키를 사용하여 HMAC 또는 RSA와 같은 암호화 알고리즘을 사용하여 생성됩니다.
- 간단한 동작 과정
  - 사용자 인증
  - 서버는 클라이언트에게 JWT를 발급
  - 클라이언트는 이후 요청에서 이 토큰을 사용하여 인증을 유지
- 종종 웹어플리케이션의 경우 Cookie의 장점(XSS, 중간자 공격 방어 등)을 활용하기 위해, Cookie 실어서 보내기도 함.

### OAuth 2.0

- OAuth 2.0은 웹 및 애플리케이션 간의 안전한 리소스 공유를 위한 **표준 인증 프로토콜**입니다.
- **주로 사용자의 계정 정보를 제3자 애플리케이션에게 제공할 때 사용**합니다. **제3자 애플리케이션에게 사용자의 리소스에 대한 접근 권한을 안전하게 위임하는 것이 기본 목적**입니다.
- 다양한 인증흐름(**Authorization Code**, Implict, Resource Owner Password Credentials, **Client Credentials**)을 제공합니다.
  - Authorization Code: 소셜 로그인
  - Client Credentials: 서버에서 외부 API 연동하기
- 대부분의 **아이덴티티 공급업체(Identity Provider, IdP; e.g. 구글, 페이스북)**가 표준을 따르고 있습니다.

### OpenID

- OpenID는 사용자가 여러 서비스에서 동일한 인증 정보를 사용하여 로그인할 수 있도록 해주는 분산된 사용자 인증 시스템입니다.
- 특징
  - **단일 로그인(Single Sign-On, SSO)**: 사용자는 하나의 OpenID 신원(예: URL 또는 URI)을 사용하여 여러 서비스에 로그인할 수 있습니다.
  - **분산된 인증**: OpenID 인증은 중앙 집중식 서버가 아니라, 여러 OpenID 제공자(Identity Provider)들에 의해 이루어집니다. 사용자는 자신을 인증할 OpenID 제공자를 선택할 수 있습니다.
  - **사용자 통제 하에 있는 개인 정보**: 사용자는 어떤 정보를 어떤 서비스와 공유할지를 직접 통제할 수 있습니다. 이는 프라이버시 보호와 관련된 사용자의 우려를 줄여 줍니다.
  - **OAuth 2.0 표준 위의 추가 계층**: OAuth 2.0은 애플리케이션에 사용자의 대리 접근 권한을 부여하는 메커니즘을 제공합니다. 그러나 OAuth 2.0 자체는 사용자가 누구인지 식별하는 방법을 정의하지 않습니다. OpenID Connect는 이를 보완하여, 인증된 사용자의 신원 정보를 나타내는 ID 토큰을 도입했습니다.
- Google, Facebook 등과 같은 **아이덴티티 공급 업체는 OpenID Connect를 구현**하여, 다른 서드파티 애플리케이션에 대한 사용자 신원 인증 서비스를 제공할 수 있습니다. 이를 통해 사용자는 소셜 로그인을 통해 다양한 애플리케이션에 접근할 수 있습니다.
- 실제로 **OpenID Connect를 활용하는 주체는 제3자 애플리케이션**(예: 우리 회사가 개발한 웹사이트나 앱)입니다. 이러한 애플리케이션은 OpenID Connect를 통해 사용자의 신원을 확인하고, 인증 정보를 기반으로 사용자에게 서비스를 제공합니다.
